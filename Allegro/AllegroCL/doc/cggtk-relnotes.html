<html><title>CG on GTK Release Notes</title>
<body><h1>Common Graphics and the IDE on GTK</h1>
<h2>Release Notes</h2>
<p>
Welcome to this preliminary release of Common Graphics and the
IDE on GTK.  Note that some features are not yet implemented, and known
bugs remain with what has been implemented.  These matters
are described here, along with incompatibilities with the
Microsoft Windows version, plus some general issues to keep in mind.
<p>
Links in this document will take you to pages on the Franz
web site for the 8.0 release, assuming you are connected to the
Internet.  Most of these links
were generated from exported symbol names in the text, so
some links are not relevant to their context.
<p>
The existing documentation for CG and the IDE (see
<a href="cgide.htm">
doc/cgide.htm</a>) was written for the existing Windows platform.
The release notes below describe cases where the behavior on the new
GTK platform differs, so refer to these notes when CG behavior
does not match the CG documenation or the behavior on Windows.
<p>
Please send bug reports and other feedback to
<a href=emailto:support@franz.com><b>support@franz.com</b></a>.
(Please put `Linux IDE' in the email subject line so we will know
you are referring to this product.)
<p>
To start the IDE, first do a (require :ide), unless you are using
an image that already contains the IDE.  Then evaluate (ide:start-ide).
Then investigate the Help menu at the rightmost end of the menu bar,
and experiment with commands on other menus.
<p>
<hr>
<h2>Contents</h2>
<a href="#header for 1.0">1.0 Features We Still Need To Implement</a><br>
<a href="#header for 2.0">2.0 Features We Probably Cannot Implement</a><br>
<a href="#header for 3.0">3.0 General Issues And Incompatibilities With The Windows Version</a><br>
<a href="#header for 4.0">4.0 Some Known Bugs</a><br>
<br><a name="header for 1.0"><h3><a href="#1.0">1.0 Features We Still Need To Implement</a></h3>
<a href="#1.1">1.1 Some widgets are not yet implemented.</a><br>
<a href="#1.2">1.2 There is no text formatting for a multi-line text edit widget.</a><br>
<a href="#1.3">1.3 Printing (hardcopy) is not implemented.</a><br>
<a href="#1.4">1.4 A standalone app may not yet have a splash pixmap or application icon.</a><br>
<a href="#1.5">1.5 Drag and drop is not supported yet.</a><br>
<a href="#1.6">1.6 Menu tooltips are not implemented yet.</a><br>
<a href="#1.7">1.7 The system menu on a child window title-bar is not yet implemented.</a><br>
<a href="#1.8">1.8 The scaling-stream class is not implemented yet.</a><br>
<a href="#1.9">1.9 Carets are not implemented yet.</a><br>
<a href="#1.10">1.10 Palettes are not implemented yet.</a><br>
<a href="#1.11">1.11 Scroll-box is not implemented.</a><br>
<br>
<a name="header for 2.0"><h3><a href="#2.0">2.0 Features We Probably Cannot Implement</a></h3>
<a href="#2.1">2.1 Some drawing functions appear to be not feasibly implementable.</a><br>
<a href="#2.2">2.2 There is no system tray icon support.</a><br>
<a href="#2.3">2.3 do-keypress and do-click are not implemented.</a><br>
<a href="#2.4">2.4 network-machines, network-shares, and connect-to-networked-machine are not implemented.</a><br>
<a href="#2.5">2.5 save-selection-when-unfocused and show-selection-when-unfocused.</a><br>
<a href="#2.6">2.6 (setf text-edit-margins) works only on multi-line controls.</a><br>
<a href="#2.7">2.7 There is no "undo" facility in the text edit control.</a><br>
<a href="#2.8">2.8 The generic function user-scroll is not called on GTK.</a><br>
<a href="#2.9">2.9 (setf cursor-position) is not implemented.</a><br>
<br>
<a name="header for 3.0"><h3><a href="#3.0">3.0 General Issues And Incompatibilities With The Windows Version</a></h3>
<a href="#3.1">3.1 CG needs to know where the GTK foreign function interface lives.</a><br>
<a href="#3.2">3.2 Font face names are different than on Windows.</a><br>
<a href="#3.3">3.3 Use font-line-height rather than font-size to determine real text height.</a><br>
<a href="#3.4">3.4 Using many fonts in GTK can slow things down greatly.</a><br>
<a href="#3.5">3.5 We have tested only on SuSE and Fedora Linux.</a><br>
<a href="#3.6">3.6 There is a single CG Event Handler process.</a><br>
<a href="#3.7">3.7 The single CG event-handling thread must NEVER call process-wait.</a><br>
<a href="#3.8">3.8 Non-parent owner windows do not work well on GTK.</a><br>
<a href="#3.9">3.9 Top-level windows are bigger than requested due to the window manager frame.</a><br>
<a href="#3.10">3.10 Top-level window frame buttons depend on window manager compliance.</a><br>
<a href="#3.11">3.11 set-foreground-window simply calls select-window</a><br>
<a href="#3.12">3.12 Do not use the exported variable *use-window-manager-frames*</a><br>
<a href="#3.13">3.13 CG avoids using certain keyboard shortcuts that are grabbed by Linux & Gnome.</a><br>
<a href="#3.14">3.14 System clipboard support is limited to plain text.</a><br>
<a href="#3.15">3.15 The IDE uses a single parent window, rather than an owner window.</a><br>
<a href="#3.16">3.16 Use *cg-timer-resolution* to adjust a timer efficiency tradeoff.</a><br>
<a href="#3.17">3.17 CG on GTK does not work on StarNet X-Win32.</a><br>
<a href="#3.18">3.18 There is no console window on Linux/Unix, unlike on Windows.</a><br>
<a href="#3.19">3.19 The IDE's preferences file is saved in your home directory.</a><br>
<a href="#3.20">3.20 A standalone app that's run from the IDE takes over the emacs listener.</a><br>
<a href="#3.21">3.21 You must use pixmap objects rather than their lower-level components.</a><br>
<a href="#3.22">3.22 You can't stretch a pixmap that has a mask.</a><br>
<a href="#3.23">3.23 Unavailable-color-mapper and pressed-color-mapper are supported only by multi-picture-button.</a><br>
<a href="#3.24">3.24 Icons are not distinct from pixmaps.</a><br>
<a href="#3.25">3.25 Windows pixmaps may be used. </a><br>
<a href="#3.26">3.26 Modal CG dialogs currently do not disable other windows.</a><br>
<a href="#3.27">3.27 You must declare a menu-item as checkable before you can check it.</a><br>
<a href="#3.28">3.28 The list-view control has only "report" view, and will not display images.</a><br>
<a href="#3.29">3.29 Button widgets may clip text or run into other widgets.</a><br>
<a href="#3.30">3.30 A tab-control cannot have multiple rows of tabs.</a><br>
<a href="#3.31">3.31 Other tab-control limitations.</a><br>
<a href="#3.32">3.32 Trackbar limitations.</a><br>
<a href="#3.33">3.33 Rubber-banding on the screen can leave droppings.</a><br>
<a href="#3.34">3.34 The wrapping property doesn't work in check-boxes and radio-buttons.</a><br>
<a href="#3.35">3.35 You can't turn off all of the radio-buttons in a cluster.</a><br>
<a href="#3.36">3.36 Click-off doesn't work for radio-buttons.</a><br>
<a href="#3.37">3.37 The HTML widget needs to know where the Mozilla GTK libraries are.</a><br>
<a href="#3.38">3.38 Limitations of the new HTML widget and browser.</a><br>
<a href="#3.39">3.39 Validate-window always validates the entire window.</a><br>
<a href="#3.40">3.40 You can't call get-pixmap on the screen.</a><br>
<a href="#3.41">3.41 key-is-down-p and key-was-down-p do not work completely as documented.</a><br>
<a href="#3.42">3.42 clipping-box is not quite compatible.</a><br>
<a href="#3.43">3.43 Pop-up-menu ignores the mouse-button argument.</a><br>
<a href="#3.44">3.44 Some GTK widgets can't have an arbitrary background or foreground color.</a><br>
<a href="#3.45">3.45 You can't remove the keyboard focus completely.</a><br>
<a href="#3.46">3.46 The double-buffered property has no effect on GTK.</a><br>
<a href="#3.47">3.47 You can't change the parent of a window from a window to the screen.</a><br>
<a href="#3.48">3.48 A transparent-pane may not have child windows.</a><br>
<a href="#3.49">3.49 The font dialog ignores several arguments.</a><br>
<a href="#3.50">3.50 Item-list widgets cannot have multiple columns.</a><br>
<a href="#3.51">3.51 How to find incompatibilities in your CG code.</a><br>
<br>
<a name="header for 4.0"><h3><a href="#4.0">4.0 Some Known Bugs</a></h3>
<a href="#4.1">4.1 The images on some buttons sometimes go bad.</a><br>
<a href="#4.2">4.2 CG Event Handler process might still hang in certain cases.</a><br>
<a href="#4.3">4.3 Picture-button background color may not match the parent when it should.</a><br>
<a href="#4.4">4.4 Some widget labels in the IDE may be clipped.</a><br>
<a href="#4.5">4.5 Widget scrollbars are still visible when not needed.</a><br>
<a href="#4.6">4.6 Clicks on static widgets go to the parent window.</a><br>
<a href="#4.7">4.7 Dismissing the inspector's "Invalid Value" dialog can wipe out the value.</a><br>
<a href="#4.8">4.8 Simple-click-toggle (of a multi-item-list) isn't working completely.</a><br>
<a href="#4.9">4.9 You can't test whether the alt key is down.</a><br>
<a href="#4.10">4.10 The new-or-existing-directory dialog doesn't handle /net directories</a><br>
<a href="#4.11">4.11 Control-H won't backspace in a single-line text control.</a><br>
<a href="#4.12">4.12 The animation option of "drawable" widgets is not smooth.</a><br>
<a href="#4.13">4.13 The Return key in the listener history drop-down pastes the wrong item.</a><br>
<a href="#4.14">4.14 Sometimes an IDE listener ends up with the prompt scrolled out of view.</a><br>
<a href="#4.15">4.15 The values returned by fontmetrics are not useful.</a><br>
<a href="#4.16">4.16 You can't jump to an item-list value by typing the first letter.</a><br>
<a href="#4.17">4.17 Inspector shortcuts like alt-U aren't working on type-in rows.</a><br>
<a href="#4.18">4.18 The inspector's history list doesn't undrop on a second click.</a><br>
<a href="#4.19">4.19 The apropos dialog's list of packages takes too long to scroll.</a><br>
<a href="#4.20">4.20 The IDE's pull-down menus are spaced oddly.</a><br>
<a href="#4.21">4.21 There are numerous GTK warnings to pursue.</a><br>
<br><hr>
<hr>
<h2><a name="1.0">1.0</a> Features We Still Need To Implement
</h2>
<p>
<hr>
<h4><a name="1.1">1.1</a> Some widgets are not yet implemented.
</h4>
<p>
The <a href="classes/cg/rich-edit.htm">rich-edit</a> and <a href="classes/cg/header-control.htm">header-control</a> widgets are not yet implemented.
(The <a href="classes/cg/header-control.htm">header-control</a> is low priority, so tell us if you need it.)
<p>
<hr>
<h4><a name="1.2">1.2</a> There is no text formatting for a multi-line text edit widget.
</h4>
<p>
There is no <a href="operators/cg/r/rich-text.htm">rich-text</a> (formatted text) capability yet in the
multi-line text control.  We have not yet delved into GTK's text
formatting functionality.
<p>
This means no colorization in the IDE editor yet (see
<a href="operators/cg/c/colorize-source-code.htm">colorize-source-code</a>).  We can probably
implement the functions for modifying the text color, fonts, and
paragraph styles as on Windows, but will not be able to support
reading the widget contents as a rich text string or placing a rich
text string into the control.
<p>
<hr>
<h4><a name="1.3">1.3</a> Printing (hardcopy) is not implemented.
</h4>
<p>
The implementor currently has no clue how to print on Linux/Unix.
<p>
<hr>
<h4><a name="1.4">1.4</a> A standalone app may not yet have a splash <a href="classes/cg/pixmap.htm">pixmap</a> or application <a href="operators/cg/i/icon.htm">icon</a>.
</h4>
<p>
We have not yet come across the way to establish an <a href="operators/cg/i/icon.htm">icon</a> for a
standalone app that would be shown in places like the alt-tab window
and the file manager.  Splash pixmaps may need to be implemented in
the base lisp similar to the way they are on Windows.  See
<a href="operators/ide/splash-file.htm">splash-file</a> and <a href="operators/ide/icon-file.htm">icon-file</a>.
<p>
<hr>
<h4><a name="1.5">1.5</a> Drag and drop is not supported yet.
</h4>
<p>
<a href="operators/cg/d/drag-and-drop.htm">Drag-and-drop</a> appears to basically work, but there is a problem
with changing the mouse <a href="classes/cg/cursor.htm">cursor</a> image as the user drags to places
where a drop is either allowed or not.  We are currently stumped
by this one.
<p>
<hr>
<h4><a name="1.6">1.6</a> <a href="classes/cg/menu.htm">Menu</a> tooltips are not implemented yet.
</h4>
<p>
These are tooltips that appear just below pull-down menus, as in the
IDE <a href="classes/cg/menu-bar.htm">menu-bar</a> on Windows.  Probably doable, but low priority since
this is a nonstandard feature.  See <a href="operators/cg/s/show-help-strings-as-tooltips.htm">show-help-strings-as-tooltips</a>.
<p>
<hr>
<h4><a name="1.7">1.7</a> The system <a href="classes/cg/menu.htm">menu</a> on a child window <a href="operators/cg/t/title-bar.htm">title-bar</a> is not yet implemented.
</h4>
<p>
The <a href="operators/cg/i/icon.htm">icon</a> at the left end of a child window's <a href="operators/cg/t/title-bar.htm">title-bar</a> is just an <a href="operators/cg/i/icon.htm">icon</a>
currently and doesn't show a <a href="classes/cg/menu.htm">menu</a> when you click on it.  This is
somewhat low priority due to those <a href="classes/cg/menu.htm">menu</a> commands being redundant with
the frame buttons.
<p>
You can change the <a href="operators/cg/i/icon.htm">icon</a> with (setf <a href="operators/cg/i/icon.htm">icon</a>) though.
<p>
<hr>
<h4><a name="1.8">1.8</a> The <a href="classes/cg/scaling-stream.htm">scaling-stream</a> class is not implemented yet.
</h4>
<p>
These are streams that map arbitrary user drawing coordinates
to pixels.  We aren't aware of people using this feature,
except for <a href="classes/cg/printer.htm">printer</a> streams, where they are built in (though
we haven't implemented printing on gtk).
<p>
Calling (setf <a href="operators/cg/s/stream-units-per-inch.htm">stream-units-per-inch</a>) on GTK will currently error.
<p>
<hr>
<h4><a name="1.9">1.9</a> Carets are not implemented yet.
</h4>
<p>
A <a href="operators/cg/c/caret.htm">caret</a> is a single flashing cursor-like thing in the currently
selected window.
<p>
<hr>
<h4><a name="1.10">1.10</a> Palettes are not implemented yet.
</h4>
<p>
A <a href="operators/cg/p/palette.htm">palette</a> is necessary only when running the windowing system in 256
colors, and use of true color is nearly universal now, so this is low
priority.
<p>
<hr>
<h4><a name="1.11">1.11</a> <a href="operators/cg/s/scroll-box.htm">Scroll-box</a> is not implemented.
</h4>
<p>
This is low priority because we aren't aware of people using it.  It
is like a special case of <a href="operators/cg/c/copy-stream-area.htm">copy-stream-area</a>.
<p>
<hr>
<hr>
<h2><a name="2.0">2.0</a> Features We Probably Cannot Implement
</h2>
<p>
<hr>
<h4><a name="2.1">2.1</a> Some drawing functions appear to be not feasibly implementable.
</h4>
<p>
These include <a href="operators/cg/f/flood-fill.htm">flood-fill</a>, <a href="operators/cg/d/draw-bezier-curve.htm">draw-bezier-curve</a>, <a href="operators/cg/b/begin-drawing-path.htm">begin-drawing-path</a>,
<a href="operators/cg/e/end-drawing-path.htm">end-drawing-path</a>, pixel, and <a href="operators/cg/s/stretch-mode.htm">stretch-mode</a>.
There's no direct support in GTK that could pass the
requests directly to the video display driver, and
implementing the drawing pixel by pixel would be very slow.
<p>
<hr>
<h4><a name="2.2">2.2</a> There is no system tray <a href="operators/cg/i/icon.htm">icon</a> support.
</h4>
<p>
As far as we know, there is no support for this in GTK / Gnome.
See <a href="classes/cg/tray-item.htm">tray-item</a>.
<p>
<hr>
<h4><a name="2.3">2.3</a> do-keypress and do-click are not implemented.
</h4>
<p>
There is probably no way to do this on GTK.
<p>
<hr>
<h4><a name="2.4">2.4</a> network-machines, network-shares, and connect-to-networked-machine are
not implemented.
</h4>
<p>
We haven't looked into the feasibility of this.
<p>
<hr>
<h4><a name="2.5">2.5</a> <a href="operators/cg/s/save-selection-when-unfocused.htm">save-selection-when-unfocused</a> and <a href="operators/cg/s/show-selection-when-unfocused.htm">show-selection-when-unfocused</a>.
</h4>
<p>
There is no option in the GTK edit control for the
<a href="operators/cg/s/save-selection-when-unfocused.htm">save-selection-when-unfocused</a> and <a href="operators/cg/s/show-selection-when-unfocused.htm">show-selection-when-unfocused</a>
properties of <a href="classes/cg/multi-line-editable-text.htm">multi-line-editable-text</a> and <a href="classes/cg/text-edit-pane.htm">text-edit-pane</a>.
The control always behaves as if both these properties are true.
<p>
<hr>
<h4><a name="2.6">2.6</a> (setf <a href="operators/cg/t/text-edit-margins.htm">text-edit-margins</a>) works only on multi-line controls.
</h4>
<p>
It is not implemented for the (<a href="operators/cg/s/single-line.htm">single-line</a>) <a href="classes/cg/editable-text.htm">editable-text</a> widget.
<p>
<hr>
<h4><a name="2.7">2.7</a> There is no "undo" facility in the text edit control.
</h4>
<p>
There is no undo in a <a href="classes/cg/text-edit-pane.htm">text-edit-pane</a>, including the IDE editor.  The
Windows control supports this internally but the GTK control presently
does not.  It's probably not feasible to implement this in CG because
CG isn't aware of everything that happens inside the control.
<p>
You can use the <b>File | Revert to Saved</b> command in the IDE Editor
to back up to the point where you most recently saved a file.
<p>
<hr>
<h4><a name="2.8">2.8</a> The generic function <a href="operators/cg/u/user-scroll.htm">user-scroll</a> is not called on GTK.
</h4>
<p>
We document that <a href="operators/cg/u/user-scroll.htm">user-scroll</a> is called for application side effects
whenever the user makes an interactive scrolling gesture, but on GTK
it is not possible to find the <a href="operators/cg/u/user-scroll.htm">user-scroll</a> arguments to pass, so it is
not called at all on GTK.
<p>
If you supplied a <a href="operators/cg/u/user-scroll.htm">user-scroll</a> method to override the default scroll
increments and call either <a href="operators/cg/s/scroll-to.htm">scroll-to</a> or scroll directly, then instead
of doing that you could supply methods for the new generic function
<a href="operators/cg/s/scroll-increment.htm">scroll-increment</a>, which will be called on all platforms whenever
the user interactively does a page scroll (scrollbar body) or line
scroll (scrollbar arrow) on a non-widget window.
<p>
<hr>
<h4><a name="2.9">2.9</a> (setf <a href="operators/cg/c/cursor-position.htm">cursor-position</a>) is not implemented.
</h4>
<p>
There is apparently no way to programmatically move the mouse <a href="classes/cg/cursor.htm">cursor</a>
in GTK.  This is probably an X philosophy restriction.
<p>
<hr>
<hr>
<h2><a name="3.0">3.0</a> General Issues And Incompatibilities With The Windows Version
</h2>
<p>
Here are some issues that you may generally need to keep in mind when
writing CG code for GTK.  These are mainly things that cannot work
quite as they do on Microsoft Windows or as currently documented.
<p>
<hr>
<h4><a name="3.1">3.1</a> CG needs to know where the GTK foreign function interface lives.
</h4>
<p>
If you load the CG fasl files and it does not find loadgtk20.cl and
the rest of the GTK foreign function interface in a "gtk" subdirectory
of the directory that contains the lisp executable, then a break will
happen that tells you to set excl:*gtk-root* to the GTK FFI directory.
<p>
<hr>
<h4><a name="3.2">3.2</a> Font face names are different than on Windows.
</h4>
<p>
If you are using existing CG code from the Windows platform on CG,
then CG will map some common Windows font face names to GTK font face
names automatically.  The mapping may not produce a desirable font,
though, so you may need to conditionalize your font face names using
#+mswindows and #+gtk.
<p>
Note that GTK appears to use its own fonts rather then the X server's
fonts, and many of them do not look very good at some sizes,
especially smaller sizes.  (The non-bold fonts are too thin, while the
bold fonts have uneven stroke width.)  It may take a fair amount of
trial-and-error to find pleasing fonts.
<p>
You can evaluate (<a href="operators/cg/f/font-faces.htm">font-faces</a> (<a href="classes/cg/screen.htm">screen</a> <a href="variables/cg/s_system_s.htm">*system*</a>)) to find the GTK
font face names.
<p>
Some GTK font faces may not work at all, and GTK may print a warning
if you use them.  We don't see a way to programmatically determine
this in CG.
<p>
Here is the current automatic mapping from some Windows font names to
GTK names, currently held in the internal variable
*windows-font-face-to-gtk*.
<p>
<pre>
Arial             --> Sans
Arial Black       --> Lucida
Times New Roman   --> Serif
Ms Serif          --> Serif
Ms Sans Serif     --> Sans
Courier New       --> Courier
System            --> Sans
Fixedsys          --> Courier
</pre>
<p>
All other face names that aren't found will default to "Sans", which
is a variable-width sans-serif font.
<p>
The <a href="operators/cg/f/font-family.htm">font-family</a> of any font is totally ignored on GTK.
<p>
You can't count on all GTK installations having any particular
font.  For example, we have one machine that does not have
"Adobe Courier" while another does not have "Courier".  So an
application that you distribute should probably search the
list returned by (<a href="operators/cg/f/font-faces.htm">font-faces</a> (<a href="classes/cg/screen.htm">screen</a> <a href="variables/cg/s_system_s.htm">*system*</a>)) for the first
suitable font face that's found on that machine.
<p>
<hr>
<h4><a name="3.3">3.3</a> Use <a href="operators/cg/f/font-line-height.htm">font-line-height</a> rather than <a href="operators/cg/f/font-size.htm">font-size</a> to determine real text height.
</h4>
<p>
On GTK, text may draw at a different pixel height than the <a href="operators/cg/f/font-size.htm">font-size</a>
that was requested for a font.  To determine how much space to allow
for text, call <a href="operators/cg/f/font-line-height.htm">font-line-height</a> rather than <a href="operators/cg/f/font-size.htm">font-size</a>.
<a href="operators/cg/f/font-line-height.htm">Font-line-height</a> should work fine on Windows as well, where <a href="operators/cg/f/font-size.htm">font-size</a>
would also work.  There is also the new function <a href="operators/cg/f/font-pixel-height.htm">font-pixel-height</a>,
which is like <a href="operators/cg/f/font-line-height.htm">font-line-height</a> except excluding the blank "leading" on
the top and/or bottom of the text.  <a href="operators/cg/f/font-line-height.htm">Font-line-height</a> is probably more
useful.
<p>
Font sizes may now be non-integers.  This was done mostly to allow
non-integer CG font pixel sizes to map to integral point sizes, where
the fonts seem to look nicer on GTK.
<p>
This next problem applies only to GTK 2.4; this should no longer
be a concern in CG under GTK 2.6 and later:
In order for fonts to draw at the requested pixel size on GTK, you
must go to the window manager's Control Center (or equivalent) and
change "Fonts | Details | Resolution / dots per inch" to the proper
magic value.  (In Gnome 2.0 this is instead under Start <a href="classes/cg/menu.htm">Menu</a> |
Preferences.)  The GTK docs say only that 96 is typically the
appropriate value for a display (monitor).  Our experimentation
indicates that a font resolution of 96 is appropriate when the <a href="classes/cg/screen.htm">screen</a>
resolution is 1280 by 1024, and 75 is good when the <a href="classes/cg/screen.htm">screen</a> resolution
is 1024 by 768.  But keep in mind that your end users may use
different settings, so it's best to call <a href="operators/cg/f/font-line-height.htm">font-line-height</a> to see how
big the fonts will really be drawn.
<p>
Some widgets that are children of GTK dialogs (such as the File
dialog) or of children of complex GTK widgets will use default GTK
fonts rather than CG defaults.  The size of these fonts can depend on
your Control Center font choices or on your ~/.gtkrc file.
<p>
<hr>
<h4><a name="3.4">3.4</a> Using many fonts in GTK can slow things down greatly.
</h4>
<p>
If an application uses many different fonts, the redisplay of windows
can slow down greatly.  From the behavior that we see, our impression
is that the X server is caching all of the pixel data of the fonts
that have most recently been used, and if all of the fonts that
an application frequently uses do not fit into the X server's
cache, then a lot of time is spent reloading font data that has
been replaced by more recently used fonts.
<p>
On the developer's
machine, for example, about 16 fonts will typically fit (though it
depends on the particular fonts being used), and so if a window
uses 16 fonts then there is no problem, but if it uses 17 fonts,
then every time it draws the next font it must load it again due
it having been displaced by the previously drawn font, and this
can cause the redisplay to take a few seconds.
<p>
So an application should minimize the variety of fonts that it
uses simultaneously.  Note that a different size or boldness of
the same font face, for example, is still a different font.
<p>
<hr>
<h4><a name="3.5">3.5</a> We have tested only on SuSE and Fedora Linux.
</h4>
<p>
If you test on some other x86 Linux, we would be especially interested
in hearing how it goes.  It should work as long as you have GTK 2.4
or later.
<p>
<hr>
<h4><a name="3.6">3.6</a> There is a single CG Event Handler process.
</h4>
<p>
On Windows, events arrive in the process that created the window for
the event, and so events generally are handled in the <a href="operators/cg/c/creation-process.htm">creation-process</a>
of a Window.  This does not work on virtual threads platforms, which
includes our Linux/Unix lisps currently, because there is a single
event queue for the single real OS thread, which leads to confusion if
multiple lisp processes read from the single queue.  So on virtual threads
platforms CG uses a single process (called "CG Event Handler") to
handle all events.  This should not be a porting issue for most
applications, but would be if you depend on code to run in particular
CG processes.
<p>
For these reasons, <a href="operators/cg/f/find-or-make-application-window.htm">find-or-make-application-window</a> does not make a
separate copy of the window in each lisp process in which the function
is called.
<p>
The event handler process will be the value of
<a href="variables/cg/s_single-cg-event-handling-process_s.htm">*single-cg-event-handling-process*</a>.  This variable will be nil on
"real threads" platforms, or when CG is not initialized.
<p>
If you are calling <a href="operators/cg/p/process-pending-events.htm">process-pending-events</a> in processes other than the
CG event handler and confusion results due to multiple processes
alternately handling events from the single queue, then you might try
calling <a href="operators/cg/p/process-pending-events-if-event-handler.htm">process-pending-events-if-event-handler</a> instead, which does
nothing unless the calling process is the single event handler
process.
<p>
<hr>
<h4><a name="3.7">3.7</a> The single CG event-handling thread must NEVER call <a href="operators/mp/process-wait.htm">process-wait</a>.
</h4>
<p>
On virtual threads it is not feasible for event-handling to continue
being done inside a <a href="operators/mp/process-wait.htm">process-wait</a>, and so all event handling will hang
if the event-handling process calls <a href="operators/mp/process-wait.htm">process-wait</a>.  This is an
important issue because most application code generally runs in this
process, because application code is generally triggered by mouse
clicks and keystrokes that are handled as events.
<p>
We have exported the function <a href="operators/cg/c/cg-process-wait.htm">cg-process-wait</a> that you could call in a
CG application in place of calling <a href="operators/mp/process-wait.htm">process-wait</a>.  (It is not clear if this
is the final solution that we will offer.)  In most cases this
function simply calls <a href="operators/mp/process-wait.htm">process-wait</a>, but when called in the single CG
event-handling process on a virtual threads platform it will instead
enter its own loop where it calls <a href="operators/cg/p/process-pending-events.htm">process-pending-events</a>, then the
wait function, and then (sleep 0.1) repeatedly until the wait function
returns true.  It also handles any tasks that were queued by calls to
<a href="operators/cg/p/post-funcall-in-cg-process.htm">post-funcall-in-cg-process</a>.
<p>
You might alternately want to pass tasks that might call <a href="operators/mp/process-wait.htm">process-wait</a>
to another process by calling <a href="operators/cg/p/post-funcall-in-cg-process.htm">post-funcall-in-cg-process</a>.  The IDE
uses that function to pass tasks between the CG event handler process
and the IDE listener processes, for example.
<p>
<hr>
<h4><a name="3.8">3.8</a> Non-parent owner windows do not work well on GTK.
</h4>
<p>
If you create a non-child window that has an owner window, GTK will
keep the owned window in front of the owner and will shrink the owned
window with the owner, as it should.  But it will allow windows of other
applications to come between the owned window and its owner in the
occlusion stack, and the window manager will have a separate taskbar
button for each top-level owned window.
<p>
Therefore, we recommend converting the non-child owned windows (other
than modal dialogs) in your applications into child windows.  We have
done this to the IDE by turning its owner window into a parent window.
(You could turn it back into an owner window by setting the
<a href="operators/ide/use-ide-parent-window.htm">use-ide-parent-window</a> <a href="classes/cg/configuration.htm">configuration</a> option to nil before starting up
the IDE, but it may not work well on GTK.)
<p>
Another reason not to use separate top-level windows is that there
seems to be no way to programmatically move the keyboard focus to a
different top-level window, unless the all-knowing window manager is
in the mood to move it there.
<p>
<hr>
<h4><a name="3.9">3.9</a> Top-level windows are bigger than requested due to the window manager
frame.
</h4>
<p>
In X the window manager officially gets to control where it puts a new
top-level window.  It will generally put them where you ask, but will
wrap a <a href="operators/cg/b/border.htm">border</a> of unknown size around the window.  In CG, the window
will generally appear with the top left corner of the window manager
frame at the requested top left position, but the window will be
larger than the requested <a href="operators/cg/e/exterior.htm">exterior</a> by the size of the window manager
frame.
<p>
Thereafter, retrieving or changing the <a href="operators/cg/e/exterior.htm">exterior</a> or <a href="operators/cg/i/interior.htm">interior</a> of a
top-level window may work according to the CG design, though it is
very tricky to make this work accurately due to the X philosophy where
an application is not supposed to care where the exteriors of its
top-level windows are.  Child windows, on the other hand, are
completely under CG's control.
<p>
<hr>
<h4><a name="3.10">3.10</a> Top-level window frame buttons depend on window manager compliance.
</h4>
<p>
A top-level window may not have the set of frame buttons (for
maximizing, minimizing, and closing) that you requested if the
window manager does not obey CG's request to add or remove
particular buttons.
<p>
A top-level window will never have the
"question mark" help button.  CG implements this button for child
windows (to emulate this Microsoft Windows feature), but cannot
do so in window manager frames for top-level windows.
<p>
<hr>
<h4><a name="3.11">3.11</a> <a href="operators/cg/s/set-foreground-window.htm">set-foreground-window</a> simply calls <a href="operators/cg/s/select-window.htm">select-window</a>
</h4>
<p>
In GTK there is nothing that corresponds to the functionality
that <a href="operators/cg/s/set-foreground-window.htm">set-foreground-window</a> uses on Windows to bring an application's
thread to the foreground.  So on GTK, <a href="operators/cg/s/set-foreground-window.htm">set-foreground-window</a> simply
calls <a href="operators/cg/s/select-window.htm">select-window</a>, and <a href="operators/cg/f/foreground-window.htm">foreground-window</a> simply calls <a href="operators/cg/s/selected-window.htm">selected-window</a>
on the <a href="classes/cg/screen.htm">screen</a>.
<p>
Calling <a href="operators/cg/s/select-window.htm">select-window</a> on a window in an application that is not
the currently selected application may produce different results
with different window managers.  On the developer's machine, it
brings the application to the front, but does not move the
keyboard focus to it, and so the user must still use either a
mouse click or an alt-tab gesture to give the application the
keyboard focus.
<p>
<hr>
<h4><a name="3.12">3.12</a> Do not use the exported variable *use-window-manager-frames*
</h4>
<p>
It was intended that an application could set
*use-window-manager-frames* to nil to cause top-level windows
to use Common Graphics <a href="operators/cg/t/title.htm">title</a> bars and borders rather than
window manager <a href="operators/cg/t/title.htm">title</a> bars and borders, perhaps to avoid
the unpredictability of arbitrary window managers.  But this
option leads to focusing problems that do not appear to be
resolvable, so we expect to unexport this variable in the next
release.
<p>
<hr>
<h4><a name="3.13">3.13</a> CG avoids using certain keyboard shortcuts that are grabbed by Linux &
Gnome.
</h4>
<p>
Most of the keystrokes that combine a function key with the alt key
(plus perhaps other shift keys) are grabbed either by Linux or by
Gnome's default shortcuts, and CG cannot intercept them.  For
compatibility with existing CG code, CG will automatically map these
keystrokes to other ones whenever they are specified as keyboard
shortcuts.
<p>
The general rule is that if a <a href="classes/cg/menu-bar.htm">menu-bar</a> shortcut includes both a
function key and the alt key, then the corresponding numeral key is
used on GTK instead of the function key.  So alt-F1 will be converted
automatically to alt-1, for example.  As special cases, F10 maps to
the zero key, F11 to the minus key, and F12 to the equals key.
<p>
This affects the IDE <a href="classes/cg/menu-bar.htm">menu-bar</a>, where for example the Run | Trace
Dialog command becomes alt-8, while the Run | Trace command is still
F8.  Check the shortcuts printed in the <a href="classes/cg/menu-bar.htm">menu-bar</a> menus as needed.
<p>
If you happen to suspend the X server accidentally with a keystroke
like control-alt-F8, you can get it back with control-alt-F7.
<p>
Also, Gnome uses control-alt-D by default to iconize all applications,
so Build Project Distribution is control-alt-Q on GTK.
<p>
GTK appears to grab the F10 key as a special case to show the
leftmost <a href="classes/cg/menu.htm">menu</a> on the <a href="operators/cg/t/title-bar.htm">title-bar</a> of the top-level window, if any.
To handle the F10 key (with no shift keys), you must add a method
to the generic function handle-f10.
<p>
<hr>
<h4><a name="3.14">3.14</a> System clipboard support is limited to plain text.
</h4>
<p>
Only the :text format of the function <a href="operators/cg/c/clipboard-object.htm">clipboard-object</a>
is supported for passing information
on the system clipboard between lisp and other applications.
The :pixmap format may be supportable in the future, but the
:rich-text format (or formatted text in general) does not
appear to be supportable.
<p>
Arbitrary lisp objects may still be passed on the lisp
clipboard within a lisp application by calling
<a href="operators/cg/p/push-lisp-clipboard.htm">push-lisp-clipboard</a> and <a href="operators/cg/p/pop-lisp-clipboard.htm">pop-lisp-clipboard</a>.
<p>
<hr>
<h4><a name="3.15">3.15</a> The IDE uses a single parent window, rather than an owner window.
</h4>
<p>
The main reason is that non-parent owner windows do not work well on GTK,
as explained elsewhere in this document.
<p>
The IDE <a href="classes/cg/status-bar.htm">status-bar</a> has moved to the bottom of the IDE when an IDE
parent window is used.
<p>
<a href="operators/cg/d/development-main-window.htm">Development-main-window</a> will return the main IDE child pane on which
the IDE tool dialogs live.  The parent of this window is the top-level
IDE window.  The new exported function <a href="operators/ide/top-ide-window.htm">top-ide-window</a> returns the
parent.  The new exported function <a href="operators/ide/main-ide-window.htm">main-ide-window</a> returns the child,
and may replace the more awkward function <a href="operators/cg/d/development-main-window.htm">development-main-window</a>.
<p>
The main IDE area is scrollable when the IDE parent window is used.
There are keyboard shortcuts on the View | Manage Windows <a href="classes/cg/menu.htm">menu</a> to
scroll it quickly with the keyboard.
<p>
The Background Window does not appear on the View <a href="classes/cg/menu.htm">menu</a> when using a
single IDE parent window, and in its place is a Maximize IDE command
to make the IDE fill the <a href="classes/cg/screen.htm">screen</a>.  The maximization <a href="operators/cg/s/state.htm">state</a> will be
saved in your prefs file so that the IDE starts up maximized if it
was maximized when you last exited.
<p>
<hr>
<h4><a name="3.16">3.16</a> Use <a href="variables/cg/s_cg-timer-resolution_s.htm">*cg-timer-resolution*</a> to adjust a <a href="classes/cg/timer.htm">timer</a> efficiency tradeoff.
</h4>
<p>
Due to the way event-handling must be done on GTK, there is a tradeoff
between how quicky CG timers can be handled and how much time is
consumed by switching to the CG event-handling process to check
for <a href="classes/cg/timer.htm">timer</a> events.  The variable <a href="variables/cg/s_cg-timer-resolution_s.htm">*cg-timer-resolution*</a>
can be adjusted to adjust this tradeoff.  The default value is 0.1.
This means that CG will check for <a href="classes/cg/timer.htm">timer</a> events every tenth of a second,
and otherwise sit in a call to mp:wait-for-input-available to wait
for GTK events as other processes run.  The variable could be set
to a smaller value if you need CG <a href="classes/cg/timer.htm">timer</a> events to be handled more
frequently than that, though this makes other processes less responsive.
Or it could be set to a larger value if you aren't using timers
to perhaps make other processes more efficient.
<p>
<hr>
<h4><a name="3.17">3.17</a> CG on GTK does not work on StarNet X-Win32.
</h4>
<p>
X-Win32 does not appear to work adequately on the various popular GTK
applications that we tested, and CG is no exception.  We tested
version 6.1, patch level 1.
<p>
<hr>
<h4><a name="3.18">3.18</a> There is no console window on Linux/Unix, unlike on Windows.
</h4>
<p>
To have a listener outside of the IDE, start up a lisp in emacs and
call <a href="operators/ide/start-ide.htm">start-ide</a> to run the IDE from there.
<p>
There is no command on the View <a href="classes/cg/menu.htm">menu</a> to show the console.
<p>
<hr>
<h4><a name="3.19">3.19</a> The IDE's preferences file is saved in your home directory.
</h4>
<p>
In keeping with unix style, <a href="operators/ide/save-options-to-user-specific-file.htm">save-options-to-user-specific-file</a>
defaults to true on Linux/Unix, and so IDE preferences will normally
be saved in the file <b>~/allegro-prefs-foo.cl</b>, where foo is
the name of the machine on which lisp is running.  Including the
machine name allows a different options file to be saved for each
machine on which you run lisp, where things such as pathnames and
<a href="classes/cg/screen.htm">screen</a> resolution may be different.
<p>
<hr>
<h4><a name="3.20">3.20</a> A standalone app that's run from the IDE takes over the emacs listener.
</h4>
<p>
When you generate a standalone app from a project in the IDE (see <a href="operators/ide/build-project.htm">build-project</a>),
and run the new standalone app directly from the IDE when the modal dialog
offers to do so, then the standalone app is a subprocess of the IDE
and inherits its standard i/o streams from the IDE.  This means that
when a break occurs in the standalone app, it will print to the same
emacs buffer that the IDE's Initial Lisp Listener process uses.  Both
processes would normally then be reading from this single emacs
buffer, though the IDE would probably take precedence and prevent you
from debugging the standalone app.
<p>
To avoid that scenario, the IDE makes the Initial Lisp Listener
process go into a wait <a href="operators/cg/s/state.htm">state</a> until the standalone app exits, so that
all interaction in its emacs listener buffer will be with the
standalone app.  When the standalone app exits, the emacs buffer will
revert to being a listener in the development lisp.
<p>
This does NOT apply to running the standalone app from outside the
IDE, such as from a unix terminal.
<p>
<hr>
<h4><a name="3.21">3.21</a> You must use <a href="classes/cg/pixmap.htm">pixmap</a> objects rather than their lower-level components.
</h4>
<p>
The separate <a href="classes/cg/texture.htm">texture</a>, <a href="classes/cg/texture-info.htm">texture-info</a>, and <a href="operators/cg/p/pixmap-handle.htm">pixmap-handle</a> objects have
been deprecated for several releases in favor of the newer single
<a href="classes/cg/pixmap.htm">pixmap</a> object.  On GTK it was not feasible to make the older separate
objects work completely, so you should convert any remaining textures
in your apps into pixmaps.
<p>
If you call <a href="operators/cg/c/copy-pixels-to-stream.htm">copy-pixels-to-stream</a> on a <a href="classes/cg/texture.htm">texture</a>, an error will be
signaled to show you where your code needs to call <a href="operators/cg/c/copy-to-stream.htm">copy-to-stream</a>
instead.  (Actually you can still call <a href="operators/cg/c/copy-pixels-to-stream.htm">copy-pixels-to-stream</a> with a
<a href="operators/cg/p/pixmap-handle.htm">pixmap-handle</a> and a <a href="classes/cg/texture-info.htm">texture-info</a>, but not with a <a href="classes/cg/texture.htm">texture</a> and a
<a href="classes/cg/texture-info.htm">texture-info</a>.)
<p>
The function <a href="operators/cg/r/rotate-texture.htm">rotate-texture</a> is no longer supported on ANY platform.
You must instead call <a href="operators/cg/r/rotate-pixmap.htm">rotate-pixmap</a>.
<p>
<hr>
<h4><a name="3.22">3.22</a> You can't stretch a <a href="classes/cg/pixmap.htm">pixmap</a> that has a <a href="operators/cg/m/mask.htm">mask</a>.
</h4>
<p>
If a <a href="classes/cg/pixmap.htm">pixmap</a> has a <a href="operators/cg/m/mask.htm">mask</a> and you draw it at a size other than the size
at which it is defined, then the masking will not be done.  We don't
see a feasible way to implement this on GTK.
<p>
For picture-buttons we internally create and cache a stretched <a href="operators/cg/m/mask.htm">mask</a> to
make this work, so perhaps we could work out a way to do this when
drawing pixmaps so that the slowness of creating the <a href="operators/cg/m/mask.htm">mask</a> at the
stretched size would happen only the first time a <a href="classes/cg/pixmap.htm">pixmap</a> is drawn at a
particular size.
<p>
<hr>
<h4><a name="3.23">3.23</a> <a href="operators/cg/u/unavailable-color-mapper.htm">Unavailable-color-mapper</a> and <a href="operators/cg/p/pressed-color-mapper.htm">pressed-color-mapper</a> are supported only by
<a href="classes/cg/multi-picture-button.htm">multi-picture-button</a>.
</h4>
<p>
The <a href="classes/cg/picture-button.htm">picture-button</a> and <a href="classes/cg/static-picture.htm">static-picture</a> widgets are implemented as standard
GTK buttons, where it isn't feasible to support the
<a href="operators/cg/u/unavailable-color-mapper.htm">unavailable-color-mapper</a> and <a href="operators/cg/p/pressed-color-mapper.htm">pressed-color-mapper</a> properties.  We would
need to implement these widgets from scratch to support them.
<p>
The <a href="classes/cg/multi-picture-button.htm">multi-picture-button</a>, however, which is implemented in lisp, does
support these properties.
<p>
<hr>
<h4><a name="3.24">3.24</a> Icons are not distinct from pixmaps.
</h4>
<p>
<a href="operators/cg/e/extract-icon-from-file.htm">Extract-icon-from-file</a> works on the same kinds of files as
<a href="operators/cg/l/load-pixmap.htm">load-pixmap</a>, and ignores its icon-number and size arguments.  It
returns a pointer that is equivalent to a <a href="classes/cg/pixmap.htm">pixmap</a> handle.
<a href="operators/cg/c/create-icon-handle.htm">Create-icon-handle</a> simply returns its <a href="classes/cg/pixmap.htm">pixmap</a> argument, for
compatibility with Windows CG code.  <a href="operators/cg/c/count-icons-in-file.htm">Count-icons-in-file</a> always
returns 1.
<p>
<hr>
<h4><a name="3.25">3.25</a> Windows pixmaps may be used. 
</h4>
<p>
<a href="operators/cg/l/load-pixmap.htm">Load-pixmap</a> works on .bmp files, so you should be able to move your
.bmp files right over from an existing CG app on Windows.  <a href="operators/cg/l/load-pixmap.htm">Load-pixmap</a>
also works on X pixmaps when called on a GTK platform.
<p>
<hr>
<h4><a name="3.26">3.26</a> Modal CG dialogs currently do not disable other windows.
</h4>
<p>
When you invoke a modal dialog, CG is currently avoiding disabling
event-handling on other windows because it was quite slow.  The
slowness seems to be when GTK redraws all of its widgets in a
grayed-out style.
<p>
You could set <a href="variables/cg/s_modal-dialogs-disable-owner_s.htm">*modal-dialogs-disable-owner*</a> to true to restore the
usual disabling.
<p>
<hr>
<h4><a name="3.27">3.27</a> You must declare a <a href="classes/cg/menu-item.htm">menu-item</a> as <a href="operators/cg/c/checkable.htm">checkable</a> before you can check it.
</h4>
<p>
To tell a <a href="classes/cg/menu-item.htm">menu-item</a> to draw a check mark at the left of its label by
calling (setf selected) or passing :selected t when creating it, you
must first declare the <a href="classes/cg/menu-item.htm">menu-item</a> to be <a href="operators/cg/c/checkable.htm">checkable</a> by passing
<b>:checkable t</b> when creating it.
<p>
The reason is that GTK will draw a box for the check mark at all
times, and leave room for it, so it must know at creation time if you
might check it.  Passing :checkable t will have no effect on the
Windows platform, where all <a href="operators/cg/m/menu-items.htm">menu-items</a> are <a href="operators/cg/c/checkable.htm">checkable</a>.
<p>
<hr>
<h4><a name="3.28">3.28</a> The <a href="classes/cg/list-view.htm">list-view</a> control has only "report" view, and will not display
images.
</h4>
<p>
We are using the <a href="classes/cg/list-view.htm">list-view</a> control provided by GTK, and it does not
support the small images at the left of each item as the Windows
control does, or the views that show icons only.  We could support
those features on GTK only by writing the control from scratch, if
there were sufficient demand.
<p>
<hr>
<h4><a name="3.29">3.29</a> Button widgets may clip text or run into other widgets.
</h4>
<p>
As of GTK 2.4, a button widget (that is, an instance of the CG
"button" class in particular) appears to have a hardcoded margin of 8
pixels on each side between the edge of the button and where the label
is drawn.  If the label text overlaps this margin, it gets clipped
there.
<p>
To prevent existing CG code from the Windows platform from clipping
most or all of the text of button widgets, CG on GTK currently makes a
button widget 4 pixels larger in each direction than requested.  In
most cases this is hopefully OK since the usual custom is not to place
button widgets directly against other widgets or the edge of the
parent.
<p>
You may still need to tweak the positioning and size of button widgets
due to this curious design of the GTK button widget.  Eventually we
could implement a button completely in CG to avoid this problem.
<p>
A quick test on GTK 2.6 appeared to show that GTK buttons no longer
have this large clipping margin, so we may contionalize this hack
to gtk 2.4.
<p>
<hr>
<h4><a name="3.30">3.30</a> A <a href="classes/cg/tab-control.htm">tab-control</a> cannot have multiple rows of tabs.
</h4>
<p>
A <a href="classes/cg/tab-control.htm">tab-control</a> with many tabs may be tedious to scroll to see all of
the tabs because the GTK control does not support multiple rows of
tabs as the Windows control does.
<p>
This was a problem in the IDE's Class Browser, and so we
replaced the <a href="classes/cg/tab-control.htm">tab-control</a> with a <a href="classes/cg/multi-picture-button.htm">multi-picture-button</a> where all buttons
are visible.
<p>
You can scroll a <a href="classes/cg/tab-control.htm">tab-control</a> quickly by holding the mouse button down
on the scroll arrow, but only if the widget's <a href="operators/cg/f/focus-on-click.htm">focus-on-click</a> property
is true, since otherwise CG will move the keyboard focus to a widget
on a tab.
<p>
<hr>
<h4><a name="3.31">3.31</a> Other <a href="classes/cg/tab-control.htm">tab-control</a> limitations.
</h4>
<p>
The <a href="operators/cg/r/ragged-right.htm">ragged-right</a> property of a <a href="classes/cg/tab-control.htm">tab-control</a> is ignored on GTK.
<p>
You cannot set the size of a tab by calling <a href="operators/cg/s/set-tab-size.htm">set-tab-size</a>.
GTK automatically fits the tab to its string.
<p>
<hr>
<h4><a name="3.32">3.32</a> <a href="classes/cg/trackbar.htm">Trackbar</a> limitations.
</h4>
<p>
The native <a href="classes/cg/trackbar.htm">trackbar</a> widget in GTK is simpler than the one
in Windows.  Specifically, it does not support the
<a href="operators/cg/t/tick-side.htm">tick-side</a>, <a href="operators/cg/t/tick-position.htm">tick-position</a>, <a href="operators/cg/t/tick-frequency.htm">tick-frequency</a>, <a href="operators/cg/s/select-range.htm">select-range</a>,
<a href="operators/cg/v/visible-range.htm">visible-range</a>, and <a href="operators/cg/n/no-pointer.htm">no-pointer</a> properties.
<p>
<hr>
<h4><a name="3.33">3.33</a> Rubber-banding on the <a href="classes/cg/screen.htm">screen</a> can leave droppings.
</h4>
<p>
If you draw on the <a href="classes/cg/screen.htm">screen</a> (over all windows) when calling functions
such as <a href="operators/cg/g/get-line.htm">get-line</a>, then garbage may be left on the <a href="classes/cg/screen.htm">screen</a> due to GTK
widgets redrawing themselves as the mouse passes over them.
<p>
We don't see a good solution for this, other than doing rubber-banding
only in a window rather than on the <a href="classes/cg/screen.htm">screen</a>, though that alternative
does not allow drawing the rubber banding line over child windows of
the specified window.
<p>
<hr>
<h4><a name="3.34">3.34</a> The <a href="operators/cg/w/wrapping.htm">wrapping</a> property doesn't work in check-boxes and radio-buttons.
</h4>
<p>
If the <a href="operators/cg/w/wrapping.htm">wrapping</a> property is turned on for a <a href="classes/cg/check-box.htm">check-box</a> or <a href="classes/cg/radio-button.htm">radio-button</a>,
the text will not wrap at spaces where needed to prevent the text from
being clipped at the right edge of the widget.
<p>
You can, however, add explicit newline characters into the <a href="operators/cg/t/title.htm">title</a> string,
and the text will always wrap there.
<p>
We could internally use a separate gtk label widget for the <a href="operators/cg/t/title.htm">title</a>, since
a label widget does support the <a href="operators/cg/w/wrapping.htm">wrapping</a> property.  But then they would
no longer act as a single widget, where you can for example click on the
label area to toggle the value, and the background of the whole widget
changes color when you move over the check box or the label.
<p>
To fix this definitively we would need to implement a <a href="classes/cg/check-box.htm">check-box</a> widget
from scratch, unless GTK adds support for this feature.
<p>
<hr>
<h4><a name="3.35">3.35</a> You can't turn off all of the radio-buttons in a <a href="operators/cg/c/cluster.htm">cluster</a>.
</h4>
<p>
Unlike on Windows, where you can set the value of every <a href="classes/cg/radio-button.htm">radio-button</a>
in a <a href="operators/cg/c/cluster.htm">cluster</a> to nil, if you try that on GTK then GTK will turn the
first button on.  This is how GTK designed the widget apparently.
<p>
<hr>
<h4><a name="3.36">3.36</a> <a href="operators/cg/c/click-off.htm">Click-off</a> doesn't work for radio-buttons.
</h4>
<p>
If you turn on the <a href="operators/cg/c/click-off.htm">click-off</a> property of a <a href="classes/cg/radio-button.htm">radio-button</a>, you still
can't turn off a <a href="classes/cg/radio-button.htm">radio-button</a> by clicking on it when it is turned on.
This is partly due to the general rule where you can't turn off all
of the radio-buttons in a <a href="operators/cg/c/cluster.htm">cluster</a> in any way.  This is how GTK designed
the widget apparently.
<p>
<hr>
<h4><a name="3.37">3.37</a> The HTML widget needs to know where the Mozilla GTK libraries are.
</h4>
<p>
If you use the IDE's help facility or create an <a href="classes/cg/html-widget.htm">html-widget</a> and the variable
excl:*mozilla-library-path* is not set to the directory containing the
libraries for the Mozilla GTK widget, then a break will occur telling
you to set that variable.
<p>
In a SuSE installation, for example, the libraries are typically at a <a href="operators/cg/p/path.htm">path</a>
such as /opt/mozilla/lib/.  The SuSE "mozilla-dev" rpm package must be
installed for these libraries to exist.
<p>
<hr>
<h4><a name="3.38">3.38</a> Limitations of the new HTML widget and browser.
</h4>
<p>
(These appear to be limitation's of Mozilla's HTML GTK widget.
Perhaps they will improve on this situation in later releases,
though the web page for this control shows no recent activity.)
<p>
You can't bring the parent of the HTML widget to the front
by clicking on the HTML widget itself, because CG's callbacks
for that event do not get called.  You need to click on
the parent directly (such as the <a href="operators/cg/t/title-bar.htm">title-bar</a> of the IDE's help
window).
<p>
The HTML browser will not put the keyboard focus into the HTML
widget when the browser is first created, for scrolling with
the keyboard.  It will do so thereafter whenever the browser
is selected, including when it is reshown after being hidden,
or when clicking it.  (Closing the IDE's help dialog
really just hides it.)
<p>
The default fixed-width font comes out very small on the developer's
machine, and there is no way to set preferences for this as you can in a
full HTML browser application.  You may want to specify explicit
font sizes when using this control in an application.
<p>
There is apparently no way to search for a string in the
displayed HTML page.
<p>
The bypass-cache and bypass-proxy arguments to <a href="operators/cg/h/html-widget-reload.htm">html-widget-reload</a>
do not do anything.  They were originally provided for the
built-in reload function of the GtkMozEmbed control, but that
function does not appear to do anything, and so <a href="operators/cg/h/html-widget-reload.htm">html-widget-reload</a>
simply visits the current uri again the usual way.
<p>
There is no implementation of <a href="operators/cg/h/html-widget-copy.htm">html-widget-copy</a>, <a href="operators/cg/h/html-widget-save.htm">html-widget-save</a>,
and <a href="operators/cg/h/html-widget-print.htm">html-widget-print</a> on GTK.
<p>
<hr>
<h4><a name="3.39">3.39</a> <a href="operators/cg/v/validate-window.htm">Validate-window</a> always validates the entire window.
</h4>
<p>
On GTK, the "box" argument to <a href="operators/cg/v/validate-window.htm">validate-window</a> is ignored,
and the entire window <a href="operators/cg/i/interior.htm">interior</a> is always validated.
<p>
<hr>
<h4><a name="3.40">3.40</a> You can't call <a href="operators/cg/g/get-pixmap.htm">get-pixmap</a> on the <a href="classes/cg/screen.htm">screen</a>.
</h4>
<p>
You must call it on a window instead.  When called on a region of a
window that is not visible, it may return whatever is on the <a href="classes/cg/screen.htm">screen</a> at
that location, but this cannot be guaranteed by CG.
<p>
<hr>
<h4><a name="3.41">3.41</a> <a href="operators/cg/k/key-is-down-p.htm">key-is-down-p</a> and <a href="operators/cg/k/key-was-down-p.htm">key-was-down-p</a> do not work completely as documented.
</h4>
<p>
We have not found a way to ask whether a key is really down now,
and so <a href="operators/cg/k/key-is-down-p.htm">key-is-down-p</a> behaves just like <a href="operators/cg/k/key-was-down-p.htm">key-was-down-p</a> when called
on GTK.  And neither of these functions return the second value,
which indicates whether the key has been pressed since the previous
call.
<p>
<hr>
<h4><a name="3.42">3.42</a> <a href="operators/cg/c/clipping-box.htm">clipping-box</a> is not quite compatible.
</h4>
<p>
The box that is returned by the functions <a href="operators/cg/c/clipping-box.htm">clipping-box</a> and
<a href="operators/cg/n/nclipping-box.htm">nclipping-box</a> will exclude any part of the window that is covered by
other windows on the Windows platform, but will not exclude these
areas on GTK.
<p>
<hr>
<h4><a name="3.43">3.43</a> <a href="classes/cg/pop-up-menu.htm">Pop-up-menu</a> ignores the mouse-button argument.
</h4>
<p>
The user must use the left button to select a <a href="classes/cg/menu-item.htm">menu-item</a>.
<p>
<hr>
<h4><a name="3.44">3.44</a> Some GTK widgets can't have an arbitrary background or foreground color.
</h4>
<p>
If you try to change the <a href="operators/cg/b/background-color.htm">background-color</a> or <a href="operators/cg/f/foreground-color.htm">foreground-color</a>
of some os-widgets (which are supplied by GTK), they will not use the color.
<p>
This includes the <a href="classes/cg/multi-line-editable-text.htm">multi-line-editable-text</a>, which the IDE sometimes
uses as a faux <a href="classes/cg/static-text.htm">static-text</a> with a scrollbar, and so the background
color is not appropriate, such as in the IDE Intro guide dialog.
Perhaps there is a way to control this by formatting the text, but we
have not yet delved into text formatting.
<p>
<hr>
<h4><a name="3.45">3.45</a> You can't remove the keyboard focus completely.
</h4>
<p>
Calling (<a href="operators/cg/s/set-focus.htm">set-focus</a> nil) will do nothing on GTK.
<p>
<hr>
<h4><a name="3.46">3.46</a> The <a href="operators/cg/d/double-buffered.htm">double-buffered</a> property has no effect on GTK.
</h4>
<p>
The reason is that GTK does double-buffering itself in ALL windows.
<p>
<hr>
<h4><a name="3.47">3.47</a> You can't change the parent of a window from a window to the <a href="classes/cg/screen.htm">screen</a>.
</h4>
<p>
Or vice versa.  You can change it from one parent window to another
parent window though.
<p>
<hr>
<h4><a name="3.48">3.48</a> A <a href="classes/cg/transparent-pane.htm">transparent-pane</a> may not have child windows.
</h4>
<p>
You also cannot draw on a <a href="classes/cg/transparent-pane.htm">transparent-pane</a>.
<p>
<hr>
<h4><a name="3.49">3.49</a> The font dialog ignores several arguments.
</h4>
<p>
On GTK, <a href="operators/cg/a/ask-user-for-font.htm">ask-user-for-font</a> and pop-up-font-dialog ignore the following
arguments: stream-for-font, fixed-width-only-p, <a href="operators/cg/m/minimum-size.htm">minimum-size</a>,
maximum-size, and initial-point-size.  The dialog provided by GTK
has no options for these.
<p>
<hr>
<h4><a name="3.50">3.50</a> <a href="classes/cg/item-list.htm">Item-list</a> widgets cannot have multiple <a href="operators/cg/c/columns.htm">columns</a>.
</h4>
<p>
So the "tabs" and "<a href="operators/cg/c/column-width.htm">column-width</a>" properties are ignored.
<p>
<hr>
<h4><a name="3.51">3.51</a> How to find incompatibilities in your CG code.
</h4>
<p>
The variable <a href="variables/cg/s_gtk-compatibility-warning-action_s.htm">*gtk-compatibility-warning-action*</a> is provided to tell CG
what to do when your CG code calls something that can't be done on the
GTK platform.  The default value is :warn, which simply prints a
warning.  Changing the value to :error would cause a break to occur so
that you can look at the stack backtrace and see which function of
yours is calling the incompatible CG function.  Setting the variable
to nil would suppress the compatibility warnings.
<p>
<hr>
<hr>
<h2><a name="4.0">4.0</a> Some Known Bugs
</h2>
<p>
These are somewhat sorted from most serious to least serious.
<p>
<hr>
<h4><a name="4.1">4.1</a> The images on some buttons sometimes go bad.
</h4>
<p>
[We have seen (or heard of) this problem only on a single machine,
so please tell us if you see it.]
<p>
Sometimes many button widgets will begin drawing themselves entirely
black in their upper-left halves, along a diagonal, plus in their
label area.  The symptom can happen even on buttons inside GTK dialogs,
such as the standard file dialog, which CG does not access at all.  So it's
unclear how CG could be causing this problem, or how to debug it.
<p>
If anyone can find a way to reliably reproduce this one, then please
tell us.
<p>
<hr>
<h4><a name="4.2">4.2</a> CG Event Handler process might still hang in certain cases.
</h4>
<p>
[We haven't seen this recently, but here's how to recover
if it does happen.]
<p>
If CG windows stop redrawing their interiors and there is no response
to mouse clicks or keypresses, then the CG Event Handler process is
hung.  If it happens, you can usually free things up by going into the emacs
listener, focusing on the "CG Event Handler" process, and resetting it
with these commands:
<p>
<pre>
:foc "CG"
:res
</pre>
<p>
<hr>
<h4><a name="4.3">4.3</a> <a href="classes/cg/picture-button.htm">Picture-button</a> background color may not match the parent when it should.
</h4>
<p>
If a <a href="classes/cg/multi-picture-button.htm">multi-picture-button</a> or other picture widget uses pixmaps
that use the default <a href="classes/cg/pixmap.htm">pixmap</a> color vector, then <a href="variables/cg/light-gray.htm">light-gray</a> pixels
in the pixel data should get mapped to the <a href="operators/cg/s/system-dialog-background-color.htm">system-dialog-background-color</a>
and therefore should match the background color of the widget itself
and/or its parent window if they use the <a href="operators/cg/s/system-dialog-background-color.htm">system-dialog-background-color</a>.
On one test machine the colors did match in this way in the IDE's
<a href="operators/cg/t/toolbars.htm">toolbars</a>.
<p>
<hr>
<h4><a name="4.4">4.4</a> Some widget labels in the IDE may be clipped.
</h4>
<p>
If the default font is larger on GTK than it was on Windows, this is
causing some pieces of text in IDE widgets to be chopped off.  This
probably happens only prior to Pango 1.8 (typically included with
GTK 2.6), when CG could not determine the real pixel size of a font.
<p>
<hr>
<h4><a name="4.5">4.5</a> Widget <a href="operators/cg/s/scrollbars.htm">scrollbars</a> are still visible when not needed.
</h4>
<p>
If you request a vertical or horizontal scrollbar for an OS widget
(one provided by GTK) such as an <a href="classes/cg/item-list.htm">item-list</a> or a
<a href="classes/cg/multi-line-editable-text.htm">multi-line-editable-text</a>, then the scrollbar(s) will be visible all of
the time, even when there is nothing scrolled out of view.  You may
need to make item-lists, for example, in your application somewhat
wider to allow for this.
<p>
These GTK widgets do provide an option for the <a href="operators/cg/s/scrollbars.htm">scrollbars</a> to turn off
automatically when not needed, but when we enable this option a crash
occurs when the scrollbar turns itself off.  This happens
asynchronously later, when some event comes in that we have failed to
track down, but we hope to find it eventually.
<p>
<hr>
<h4><a name="4.6">4.6</a> Clicks on static widgets go to the parent window.
</h4>
<p>
When you click on a <a href="classes/cg/static-text.htm">static-text</a>, the parent (only) gets the events.
When you click on a <a href="classes/cg/static-picture.htm">static-picture</a>, both it and the parent get the
events.
<p>
<hr>
<h4><a name="4.7">4.7</a> Dismissing the inspector's "Invalid Value" dialog can wipe out the value.
</h4>
<p>
If you type an invalid value and a dialog appears to tell you that
the value is invalid and you press the space bar to dismiss the
dialog, the space also gets typed into the inspector and wipes out
the current value on the selected row.
<p>
<hr>
<h4><a name="4.8">4.8</a> <a href="operators/cg/s/simple-click-toggle.htm">Simple-click-toggle</a> (of a <a href="classes/cg/multi-item-list.htm">multi-item-list</a>) isn't working completely.
</h4>
<p>
If you specify the <a href="operators/cg/s/simple-click-toggle.htm">simple-click-toggle</a> option of a <a href="classes/cg/multi-item-list.htm">multi-item-list</a>
widget, then doing a simple left click on an item that is already
selected will deselect all other items rather than deselecting only
the clicked item as CG specifies.
<p>
This affects some IDE dialogs such as the list of included modules in
the Project Manager.
<p>
<hr>
<h4><a name="4.9">4.9</a> You can't test whether the alt key is down.
</h4>
<p>
The functions <a href="operators/cg/d/down-keys.htm">down-keys</a>, <a href="operators/cg/d/down-key-names.htm">down-key-names</a>, and <a href="operators/cg/k/key-is-down-p.htm">key-is-down-p</a> will always
claim that the alt key is not down.  CG is currently doing this on
purpose to avoid a problem where an alt-tab gesture sends us the event
for pressing the key but not for releasing it, leaving CG believing
that the key is still down.
<p>
<hr>
<h4><a name="4.10">4.10</a> The new-or-existing-directory dialog doesn't handle /net directories
</h4>
<p>
The <a href="operators/cg/a/ask-user-for-new-or-existing-directory.htm">ask-user-for-new-or-existing-directory</a> dialog can access non-local
directories via links, but will not show all networked machines under
the /net item.  The non-unix-expert implementor isn't sure whether
that's important or feasible.
<p>
<hr>
<h4><a name="4.11">4.11</a> Control-H won't backspace in a <a href="operators/cg/s/single-line.htm">single-line</a> text control.
</h4>
<p>
It does nothing in an <a href="classes/cg/editable-text.htm">editable-text</a> or <a href="classes/cg/combo-box.htm">combo-box</a>.  We need to implement
that in CG.
<p>
<hr>
<h4><a name="4.12">4.12</a> The animation option of "<a href="classes/cg/drawable.htm">drawable</a>" widgets is not smooth.
</h4>
<p>
This is judging from the Navigator example.  In general timers
are working fine though.  We haven't looked into the <a href="classes/cg/drawable.htm">drawable</a>
at all yet; it just happens to be mostly working.
<p>
<hr>
<h4><a name="4.13">4.13</a> The Return key in the listener history drop-down pastes the wrong item.
</h4>
<p>
If you drop the listener history list and use the down arrow key to
move to a different item and press the Enter key, it pastes the
originally selected item rather than the focused item.  For now, use
the spacebar instead to correctly pick the focused item.
<p>
<hr>
<h4><a name="4.14">4.14</a> Sometimes an IDE listener ends up with the prompt scrolled out of view.
</h4>
<p>
This can happen for example when resizing the Debug Window, for
example.  Sometimes if something is printed to the listener and you
use the keyboard to scroll to the bottom of the text, it still will
not scroll to the bottom if the text <a href="classes/cg/cursor.htm">cursor</a> was already at the end.
<p>
<hr>
<h4><a name="4.15">4.15</a> The values returned by <a href="classes/cg/fontmetrics.htm">fontmetrics</a> are not useful.
</h4>
<p>
The functions <a href="classes/cg/fontmetrics.htm">fontmetrics</a> and <a href="operators/cg/n/nfontmetrics.htm">nfontmetrics</a>, as well as accessors of
them such as <a href="operators/cg/f/font-height.htm">font-height</a>, do not seem to correspond to reality.  These
values are coming directly from GTK, and we don't know how to convert
them to meaningful values.  Call <a href="operators/cg/l/line-height.htm">line-height</a> on a stream to find out
how tall it is really drawing its current font, or call
<a href="operators/cg/f/font-line-height.htm">font-line-height</a> directly on the font.
<p>
<hr>
<h4><a name="4.16">4.16</a> You can't jump to an <a href="classes/cg/item-list.htm">item-list</a> value by typing the first letter.
</h4>
<p>
We need to implement this from scratch on GTK, since it's not built
into the control.
<p>
<hr>
<h4><a name="4.17">4.17</a> Inspector shortcuts like alt-U aren't working on type-in rows.
</h4>
<p>
<hr>
<h4><a name="4.18">4.18</a> The inspector's history list doesn't undrop on a second click.
</h4>
<p>
If you click on the inspector's history list and then click again in
the same place to undrop the <a href="classes/cg/outline.htm">outline</a> without selecting an item, then
the <a href="classes/cg/outline.htm">outline</a> drops down again.  Other dropping outlines do not have
this problem.
<p>
<hr>
<h4><a name="4.19">4.19</a> The apropos dialog's list of packages takes too long to scroll.
</h4>
<p>
There are now so many child packages in CG and the IDE that the
cumbersome scrolling technique of GTK menus takes way too long.
Perhaps we should not list all of those child packages, and
make the parent package work for symbols in them.
<p>
<hr>
<h4><a name="4.20">4.20</a> The IDE's pull-down menus are spaced oddly.
</h4>
<p>
The menus on the IDE's <a href="classes/cg/menu-bar.htm">menu-bar</a> are space unevenly and farther
apart than usual for GTK apps.  This is a mystery since the GTK
API does not appear to provide any control over this.
<p>
<hr>
<h4><a name="4.21">4.21</a> There are numerous GTK warnings to pursue.
</h4>
<p>
Lots of warnings are still being printed by GTK to the Emacs Listener.
We will be pursuing all of these eventually, though they take a while
to track down, and at least some of them can occur with the GTK
utility dialogs, for example, where it does not appear that CG
can be at fault.
<p>
<hr>
<hr>
</h2>
<p>
</body></html>
