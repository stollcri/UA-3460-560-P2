<html><head><meta http-equiv="content-type" name="description" content="text/html; charset=UTF-8"> <title>chdir</title><link rel="stylesheet" href="../../acldoc-styles.css" type="text/css"></head><body><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"><b>Function</b></td><td align="left" bgcolor="#00FFFF"><b>Package: excl</b></td><td align="center" bgcolor="#00FFFF"><a href="../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faqs/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 8.2</b><br><small><a href="../../introduction.htm#updates-s">Unrevised from 8.1 to 8.2.</a></small><br><a href="http://www.franz.com/support/documentation/8.1/doc/operators/excl/chdir.htm">8.1 version</a></td></tr></table><h2 id="2">chdir</h2>

<p id="3"><b>Arguments: </b><i></i> &amp;optional <i>directory</i></p>

<p id="4">
The new <code>:osi</code> module, released after the release of
Allegro CL 6.2, has additional functionality relating to file
handling. The symbol <code>excl:chdir</code> is exported from
the new <code>excl.osi</code> package (as well as from the
<code>excl</code> package). See <a href="../../os-interface.htm#osi-file-handling-2">OSI file handling functionality</a> in
<a href="../../os-interface.htm">os-interface.htm</a>.
</p>

<p id="5">
This function is designed to mimic the UNIX/DOS <strong>cd</strong>
utility. In short, it extracts the directory component of
<i>directory</i> and changes the current working
directory to that. If the directory component is relative, the new
directory is determined relative to the current working directory (as
returned by <a href="current-directory.htm"><b>current-directory</b></a>).
<i>directory</i> can be a pathname object or a string.
</p>
<p id="6">
Note that this function does not modify the value of <a href="../../../ansicl/dictentr/default-.htm"><code>*default-pathname-defaults*</code></a>. Therefore, after
calling this function, it is likely that the current directory, as
returned by <a href="current-directory.htm"><b>current-directory</b></a>, will be differrent from the
directory specified in <a href="../../../ansicl/dictentr/default-.htm"><code>*default-pathname-defaults*</code></a>. The related
top-level command <a href="../../tpl-commands/cd.htm"><b>:cd</b></a> does modify
the value of <a href="../../../ansicl/dictentr/default-.htm"><code>*default-pathname-defaults*</code></a>. The following form
modifies both the current directory and <a href="../../../ansicl/dictentr/default-.htm"><code>*default-pathname-defaults*</code></a>:
</p>
<pre id="7">
(setf *default-pathname-defaults* (pathname (chdir directory)))
</pre>
<p id="8">
Because of a mismatch between UNIX and Common Lisp
interpreting of strings naming directories, string arguments are
handled specially, as we describe now. The following table shows the
behavior of <a href="chdir.htm"><b>chdir</b></a> given
various values of pathname:
</p>

<div align="left">

<table BORDER="1" CELLSPACING="1" CELLPADDING="8" WIDTH="576">
  <tr>
    <td WIDTH="25%" VALIGN="TOP"><p id="9" ALIGN="CENTER"><strong>pathname is</strong></p></td>
    <td WIDTH="67%" VALIGN="TOP"><p id="10" ALIGN="CENTER"><strong>Action by chdir</strong></p></td>
  </tr>
  <tr>
    <td WIDTH="25%" VALIGN="TOP">not specified</td>
    <td WIDTH="67%" VALIGN="TOP">Change to the current user's home directory on UNIX, to c:\
    on Windows.</td>
  </tr>
  <tr>
    <td WIDTH="25%" VALIGN="TOP">A pathname object</td>
    <td WIDTH="67%" VALIGN="TOP">Extract the directory component of the 
    pathname (translating
    first if it is a logical pathname). Change to that directory. 
    Relative pathnames are
    resolved with respect to the current working directory (as returned by 
    <a href="current-directory.htm"><b>current-directory</b></a>).</td>
  </tr>
  <tr>
    <td WIDTH="25%" VALIGN="TOP">A string containing a /, : (colon), 
    or ; (semicolon) naming a
    pathname</td>
    <td WIDTH="67%" VALIGN="TOP">Convert to a pathname object, 
    then continue as in the `A pathname object' row of
    this table.</td>
  </tr>
  <tr>
    <td WIDTH="25%" VALIGN="TOP">A string without a /, : (colon), 
    or ; (semicolon).</td>
    <td WIDTH="67%" VALIGN="TOP">Add a / to the end of the string, 
    convert to a pathname
    object, then continue as in the `A pathname object' row
    of this table. See <strong>Note 1</strong> below.</td>
  </tr>
</table>
</div>

<p id="11">
<strong>Examples</strong>. The current Unix user's home directory
is <em>/usr/tech/doe/</em>. The directory <em>/usr/tech/doe/tmp/</em>
exists. The Allegro directory for the Lisp image is typically
<em>/usr/local/acl62/</em> though your value may be different.
</p>

<pre id="12">
user(15): (chdir) ;; no argument: change to user home directory
"/usr/tech/doe/"
user(16): (chdir "sys:") 
   ;; a string naming a logical pathname which translates
   ;; to the Allegro directory (the value you see may be different).
"/usr/local/acl62/"
user(17): (chdir)
"/usr/tech/doe/"
user(18): (chdir "tmp") ;; change to the tmp/ subdirectory
"tmp/"
user(19): (chdir (make-pathname :directory "tmp")) 
   ;; The absolute directory 
"/tmp/"
user(20): (chdir)
"/usr/tech/doe/"
user(21): </pre>

<p id="13">
<strong>Note 1</strong>. A / is added to the end of a string that
does contain a /, ;, or : in order that <code>(chdir
"tmp")</code> will work as `cd tmp' does in UNIX and DOS:
change to the <em>tmp</em> subdirectory of the current
directory. Following the ANSI CL spec, <code>(make-pathname :directory
"tmp")</code> creates the absolute pathname object with
namestring "/tmp/" while <code>(make-pathname :directory
"tmp/")</code> creates the relative pathname with namestring
"tmp/".  It is the second that follows the UNIX
paradigm. Appending a / guarantees that effect.
</p>

<p id="14">
<a href="chdir.htm"><b>chdir</b></a> returns the
namestring of the directory component of the pathname changed to. Note
that this may not be the new current directory (as returned by <a href="current-directory.htm"><b>current-directory</b></a>).
</p>

<p id="15">
<strong>Warning about interaction between chdir and foreign loading
and dumplisp</strong>: if the command line used to start Lisp
identified the Allegro CL image with a relative pathname (`./mlisp',
for example), you cannot do the first load of foreign code or dump an
image with <a href="dumplisp.htm"><b>dumplisp</b></a> after changing the
directory with this function. Therefore, if you started Lisp with a
relative pathname, do at least one foreign load before calling <a href="chdir.htm"><b>chdir</b></a> and do not call <a href="dumplisp.htm"><b>dumplisp</b></a> after calling <a href="chdir.htm"><b>chdir</b></a>. (The problem is that when
doing the first foreign load or a dumplisp, Lisp needs to examine the
running image, which it finds by examining the command line that
invoked the image. If Lisp is identified on the command line with a
relative pathname and the current directory has been changed, the
relative pathname merged with the current directory no longer points
to the running image. Changing back to the original current directory
fixes the problem.)
</p>

<p id="16">
See <a href="../../tpl-commands/cd.htm"><b>:cd</b></a>, <a href="../../tpl-commands/popd.htm"><b>:popd</b></a>, and <a href="../../tpl-commands/pushd.htm"><b>:pushd</b></a>, which also change the
current
directory.
See also <a href="../../os-interface.htm">os-interface.htm</a> for general
information on the interface between Allegro
CL and the operating system.
</p>


<hr><p id="17"><small>Copyright (c) 1998-2010, Franz Inc. Oakland, CA., USA. All rights reserved.</small><br><small>Documentation for Allegro CL version 8.2. This page was not revised from the 8.1 page.</small><br>
<small>Created 2010.1.21.</small>
<br></p><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"></td><td align="left" bgcolor="#00FFFF"></td><td align="center" bgcolor="#00FFFF"><a href="../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faqs/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 8.2</b><br><small><a href="../../introduction.htm#updates-s">Unrevised from 8.1 to 8.2.</a></small><br><a href="http://www.franz.com/support/documentation/8.1/doc/operators/excl/chdir.htm">8.1 version</a></td></tr></table></body></html>