<html><head><meta http-equiv="content-type" name="description" content="text/html; charset=UTF-8"> <title>ask-user-for-new-or-existing-directory</title><link rel="stylesheet" href="../../../acldoc-styles.css" type="text/css"></head><body><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"><b>Function</b></td><td align="left" bgcolor="#00FFFF"><b>Package: cg</b></td><td align="center" bgcolor="#00FFFF"><a href="../../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faqs/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 8.2</b><br><small><a href="../../../introduction.htm#updates-s">Unrevised from 8.1 to 8.2.</a></small><br><a href="http://www.franz.com/support/documentation/8.1/doc/operators/cg/a/ask-user-for-new-or-existing-directory.htm">8.1 version</a></td></tr></table><h2 id="2">ask-user-for-new-or-existing-directory</h2>

<p id="3"><b>Arguments: </b><i>
</i>&amp;key  (<i>owner</i> (screen *system*)) (<i>type</i> :either)<i> title prompt position width height</i> (<i>scope</i> :all) (<i>create-if-new</i> t)<i> initial-directory initial-subdirectory show-initial-directory-siblings look-ahead</i> (<i>prompt-for-password-if-needed</i> t) (<i>focus-on-new-subdirectory</i> (eq type :new))<i> close-subtrees-on-close show-initial-directory-children search-network-globally</i><i>
</i></p>

<p id="4">
This function displays a modal dialog that allows the user either to
select an existing directory or to specify a new subdirectory of an
existing directory.  Directories on local disk drives and on network
shares are displayed in an outline control; the user selects one of
these directories, and optionally (if a new directory is being
specified) types the name for a new subdirectory of the selected
directory into a text control below the outline.
</p>
<p id="5">
Two values are returned: (1) A pathname for the directory that was
specified by the user (or <code>nil</code> if the user
cancels the dialog), and (2) either <code>t</code> or
<code>nil</code>, indicating whether the directory is a
new one (that is, <code>nil</code> if there already was a
directory at the specified path, and <code>t</code> if
there was not).
</p>
<p id="6">
The arguments are:
</p>
<ul>
<li id="7">
<b><i>owner</i></b>: either the screen or a
window. Defaults to the stream returned by <a href="../s/selected-window-or-screen.htm"><b>selected-window-or-screen</b></a>. If a
window, then the modal dialog will be owned by this window (and
therefore will stay in front of it) and will be modal with respect to
this window (meaning that interactive gestures are disabled in all
other windows of the window hierarchy that has this window as its
root).  </li> <li id="8"> <i>type</i>: a keyword indicating
whether a new or existing directory (or either) is being requested.
The value must be one of the following three symbols: <ul> <li id="9">
<code>:either</code> (the default), meaning the user may specify
either a new or an existing directory.  </li> <li id="10">
<code>:new</code>, meaning only a new directory may be
specified.  </li> <li id="11"> <code>:existing</code>, meaning only an
existing directory may be specified.  </li> </ul>
<p id="12">
For either <code>:new</code> or <code>:either</code>, a
text control will appear below the outline for entering a new
subdirectory name.  For <code>:existing</code>, this control
will be hidden.
</p>
</li>
<li id="13">
<b><i>title</i></b>: a string to display in the
title-bar of the dialog.  The default string depends on the
<i>type</i> argument.

</li>
<li id="14">

<b><i>prompt</i></b>: a string to display in the body of
the dialog to instruct the user what to do. This string can be fairly
long, though the space for it is not adjusted to handle any length.
The default string depends on the type argument.

</li>
<li id="15">

<b><i>position</i></b>: either a position object (see
<a href="../m/make-position.htm"><b>make-position</b></a>)
indicating the screen position of the upper-left exterior corner of
the dialog, or <code>nil</code> (the default) to use a
default position. The default position is determined by <a href="../c/center-modal-children.htm"><b>center-modal-children</b></a> and
<a href="../c/center-all-modal-dialogs-on-screen.htm"><b>center-all-modal-dialogs-on-screen</b></a>,
as with the other built-in utility dialogs.

</li>
<li id="16">

<b><i>width</i></b>: either a positive integer
indicating the exterior pixel width of the dialog, or <code>nil</code> to use the width that was used most recently with
the specified owner, including interactive resizing that the user may
have done.  Initially a moderate default width is used.

</li>
<li id="17">

<b><i>height</i></b>: either a positive integer
indicating the exterior pixel height of the dialog, or <code>nil</code> to use the height that was used most recently
with the specified owner, including interactive resizing that the user
may have done.  Initially a moderate default height is used.

</li>
<li id="18">

<b><i>scope</i></b>: a keyword indicating whether local
disks or network shares (or both) are to be included in the outline.
The value must one of the following symbols:

<ul>
<li id="19">
<code>:all</code> (the default), meaning both local disks and
network shares are included.
</li>
<li id="20">
<code>:local</code>, meaning only local disks are included.
</li>
<li id="21">
<code>:remote</code>, meaning only network shares are included.
</li>
</ul>
</li>
<li id="22">

<b><i>create-if-new</i></b>: this argument is used only
if the user specifies a new subdirectory. In that case, if
<i>create-if-new</i> is true (the default), then the
specified subdirectory is created automatically before its pathname is
returned, and otherwise it is not. In any case, the second returned
value will be true if and only if a new subdirectory was specified.

</li>
<li id="23">

<b><i>initial-directory</i></b>: either <code>nil</code> (the default) or a pathname or namestring
indicating the directory to which the outline will initially be
opened.  The specified directory (if any) will also be initially
selected.  This option is useful for suggesting the area of the
directory hierarchy in which the user may want to select a directory,
and for making it easier for the user to browse to the probable
desired directory.  When this argument is <code>nil</code>, the outline is always opened to show only the
local disks and/or the network shares, and the topmost outline-item
will initially be selected.
<p id="24">
If this argument is a namestring rather than a pathname, it does not
matter whether the namestring contains a final slash.  Also, if the
specified directory does not exist, the outline will still initially
be opened to any upper levels of the specified directory that do
exist.  It is also OK to pass in the full pathname of a file that is
(or could be) in the desired directory; the pathname name and type
will be ignored.
</p>

</li>
<li id="25">

<b><i>initial-subdirectory</i></b>: either <code>nil</code> (the default) or a string to display initially in
the text control where the user may enter a new subdirectory
name. This argument is ignored if the <i>type</i>
argument is <code>:existing</code> (in which case the text
control for a new subdirectory will not appear at all).  When <code>nil</code>, this control will be empty initially.

</li>
<li id="26">

<b><i>show-initial-directory-siblings</i></b>: this
argument is used only when an <i>initial-directory</i>
argument is specified.  If <code>nil</code> (the default),
then each level of the outline that is opened in order to display the
initial-directory will show only the single child item that leads to
the specified <i>initial-directory</i>.  If true, then
all siblings of each opened item will also be shown initially.  The
advantages of each choice are that the first shows less clutter, while
the second provides more initial context.  The user can navigate to
any directory in either case, and a "partially open" outline-item in
the <code>nil</code> case will show a plus icon to
indicate that it has more children in addition to the one that it's
already showing.

</li>
<li id="27">

<b><i>look-ahead</i></b>: if <code>nil</code> (the default), then whenever an outline-item is
opened to show its subitems, the icons for each subitem will always
initially indicate that the subitem may be opened to show further
subitems, even if in fact there are no further subdirectories for some
or all of the newly-displayed directories. If true, then whenever new
subitems are shown, the dialog will "look ahead" to see if each of the
newly displayed subdirectories has any further subdirectories, and
will display appropriate icons for each item to inform the user
whether there will be anything further to see if each displayed item
is opened.  The advantages of each choice are that the first is
faster, while the second provides additional useful information to the
user.  This option may be particularly slow for network shares.

</li>
<li id="28">

<b><i>prompt-for-password-if-needed</i></b>: if true
(the default), then if the user attempts to open a network share but
the user's default username and password are not correct for that
share, than a dialog is shown to allow the user to enter a different
username and password.  If <code>nil</code>, then a simple
beep indicates when the user may not open a network share.

</li>
<li id="29">

<b><i>focus-on-new-subdirectory</i></b>: if this
argument is true and a valid initial-directory argument was specified,
then the keyboard focus will be initially in the text control for
typing in a new subdirectory name.  Otherwise the keyboard focus will
be initially in the outline control of the dialog.  The default for
this argument is true if the <i>type</i> argument is
<code>:new</code>, and is otherwise <code>nil</code>.  This option may be useful if the application is
asking the user for a new subdirectory when the probable parent
directory is known (and passed as the initial-directory argument); in
this case the user can typically type in the new subdirectory name
immediately and return.

</li>
<li id="30">

<b><i>close-subtrees-on-close</i></b>: the <a href="../c/close-subtrees-on-close.htm"><b>close-subtrees-on-close</b></a>
property of the outline control will be set to the value of this
argument for this call.  The default is <code>nil</code>
for each call.

</li>

<li id="31">

<b><i>show-initial-directory-children</i></b>: this
argument is used only when an <i>initial-directory</i>
argument is specified. If <code>nil</code> (the default),
then no children of the outline-item for the initial directory are
visible when the dialog appears. If true, then that outline-item is
opened to reveal any immediate subdirectories of the initial
directory.

</li>
<li id="32">

<b><i>search-network-globally</i></b>: to find the
networked machines to list, a true argument will search the network
"globally", whereas <code>nil</code> (the default) will
search only "in the current context".  The default is <code>nil</code>. This argument is passed (as the value of the
<i>global</i> keyword argument) to <a href="../../windows/network-machines.htm"><b>win:network-machines</b></a>; see that function for
more information. This argument applies to Microsoft Windows only.

</li>


</ul>

<h4 id="33">Other notes</h4>

<p id="34">
The dialog displays a file folder for each outline-item that
represents an actual directory that may be returned. This excludes
the two root items for all "Local Disks" and "Network Machines" plus
each network share (because only the descendent items of each share
represent actual directories).  These non-directory items will display
a simple triangle icon instead of a file folder.
</p>
<p id="35">
The OK button on the dialog will be disabled if no directory that may
be returned is currently specified. This includes whenever a
non-directory outline-item is selected. And if the
<i>type</i> argument is <code>:new</code>, this
also includes when the text control for the new subdirectory name is
empty. At these times, the user may not exit the dialog by pressing
the OK button or by pressing ENTER, but they may always exit by
canceling the dialog (as usual, by pressing the ESCAPE key or the
Cancel button or clicking the small close button in the frame).
</p>
<p id="36">
The similar function <a href="../a/ask-user-for-directory.htm"><b>ask-user-for-directory</b></a> invokes the
directory dialog that is provided by the operating system and which
therefore may be more familiar to users of that operating system.  But
this function has more options.
</p>

<hr><p id="37"><small>Copyright (c) 1998-2010, Franz Inc. Oakland, CA., USA. All rights reserved.</small><br><small>Documentation for Allegro CL version 8.2. This page was not revised from the 8.1 page.</small><br>
<small>Created 2010.1.21.</small>
<br></p><table border="0" width="100%" cellpadding="1" cellspacing="0"><tr><td colspan="2" bgcolor="#00FFFF"><table border="0" cellpadding="5" cellspacing="3"><tr><td align="left" bgcolor="#00FFFF"></td><td align="left" bgcolor="#00FFFF"></td><td align="center" bgcolor="#00FFFF"><a href="../../../contents.htm"><b>ToC</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../introduction.htm"><b>DocOverview</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../cgide.htm"><b>CGDoc</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../release-notes.htm"><b>RelNotes</b></a></td><td align="center" bgcolor="#00FFFF"><a href="http://www.franz.com/support/faqs/"><b>FAQ</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../index.htm"><b>Index</b></a></td><td align="center" bgcolor="#00FFFF"><a href="../../../permuted-index.htm"><b>PermutedIndex</b></a></td></tr></table></td><td align="right"><b>Allegro CL version 8.2</b><br><small><a href="../../../introduction.htm#updates-s">Unrevised from 8.1 to 8.2.</a></small><br><a href="http://www.franz.com/support/documentation/8.1/doc/operators/cg/a/ask-user-for-new-or-existing-directory.htm">8.1 version</a></td></tr></table></body></html>